using Melville.INPC;
using Melville.Pdf.LowLevel.Model.CharacterEncoding;

namespace Melville.Pdf.Model.Renderers.FontRenderings.FreeType;

public partial class ByteToMacCode : IByteToUnicodeMapping
{
    [FromConstructor] private IByteToUnicodeMapping unicodeMapping;

    public char MapToUnicode(byte input) => MapUnicodeToMacRoman(unicodeMapping.MapToUnicode(input));

    public char MapUnicodeToMacRoman(char input) => (char)(input switch
    {
        // Mappings from the MacRoman encoding on poge 653 + of the pdf spec
        (char)0xC4 => 0x80,
        (char)0xC5 => 0x81,
        (char)0xC7 => 0x82,
        (char)0xC9 => 0x83,
        (char)0xD1 => 0x84,
        (char)0xD6 => 0x85,
        (char)0xDC => 0x86,
        (char)0xE1 => 0x87,
        (char)0xE0 => 0x88,
        (char)0xE2 => 0x89,
        (char)0xE4 => 0x8A,
        (char)0xE3 => 0x8B,
        (char)0xE5 => 0x8C,
        (char)0xE7 => 0x8D,
        (char)0xE9 => 0x8E,
        (char)0xE8 => 0x8F,
        (char)0xEA => 0x90,
        (char)0xEB => 0x91,
        (char)0xED => 0x92,
        (char)0xEC => 0x93,
        (char)0xEE => 0x94,
        (char)0xEF => 0x95,
        (char)0xF1 => 0x96,
        (char)0xF3 => 0x97,
        (char)0xF2 => 0x98,
        (char)0xF4 => 0x99,
        (char)0xF6 => 0x9A,
        (char)0xF5 => 0x9B,
        (char)0xFA => 0x9C,
        (char)0xF9 => 0x9D,
        (char)0xFB => 0x9E,
        (char)0xFC => 0x9F,
        (char)0x2020 => 0xA0,
        (char)0xB0 => 0xA1,
        (char)0xA7 => 0xA4,
        (char)0x2022 => 0xA5,
        (char)0xB6 => 0xA6,
        (char)0xDF => 0xA7,
        (char)0xAE => 0xA8,
        (char)0x2122 => 0xAA,
        (char)0xB4 => 0xAB,
        (char)0xA8 => 0xAC,
        (char)0xC6 => 0xAE,
        (char)0xD8 => 0xAF,
        (char)0xA5 => 0xB4,
        (char)0xAA => 0xBB,
        (char)0xBA => 0xBC,
        (char)0xE6 => 0xBE,
        (char)0xF8 => 0xBF,
        (char)0xBF => 0xC0,
        (char)0xA1 => 0xC1,
        (char)0xAC => 0xC2,
        (char)0x192 => 0xC4,
        (char)0xAB => 0xC7,
        (char)0xBB => 0xC8,
        (char)0x2026 => 0xC9,
        (char)0xC0 => 0xCB,
        (char)0xC3 => 0xCC,
        (char)0xD5 => 0xCD,
        (char)0x152 => 0xCE,
        (char)0x153 => 0xCF,
        (char)0x2013 => 0xD0,
        (char)0x2014 => 0xD1,
        (char)0x201C => 0xD2,
        (char)0x201D => 0xD3,
        (char)0x2018 => 0xD4,
        (char)0x2019 => 0xD5,
        (char)0xF7 => 0xD6,
        (char)0x25CF => 0xD7,
        (char)0xFF => 0xD8,
        (char)0x178 => 0xD9,
        (char)0x2044 => 0xDA,
        (char)0xA4 => 0xDB,
        (char)0x2039 => 0xDC,
        (char)0x203A => 0xDD,
        (char)0xFB01 => 0xDE,
        (char)0xFB02 => 0xDF,
        (char)0x2021 => 0xE0,
        (char)0xB7 => 0xE1,
        (char)0x201A => 0xE2,
        (char)0x201E => 0xE3,
        (char)0x2030 => 0xE4,
        (char)0xC2 => 0xE5,
        (char)0xCA => 0xE6,
        (char)0xC1 => 0xE7,
        (char)0xCB => 0xE8,
        (char)0xC8 => 0xE9,
        (char)0xCD => 0xEA,
        (char)0xCE => 0xEB,
        (char)0xCF => 0xEC,
        (char)0xCC => 0xED,
        (char)0xD3 => 0xEE,
        (char)0xD4 => 0xEF,
        (char)0xD2 => 0xF1,
        (char)0xDA => 0xF2,
        (char)0xDB => 0xF3,
        (char)0xD9 => 0xF4,
        (char)0x131 => 0xF5,
        (char)0x2C6 => 0xF6,
        (char)0x2DC => 0xF7,
        (char)0xAF => 0xF8,
        (char)0x2D8 => 0xF9,
        (char)0x2D9 => 0xFA,
        (char)0x2DA => 0xFB,
        (char)0xB8 => 0xFC,
        (char)0x2DD => 0xFD,
        (char)0x2DB => 0xFE,
        (char)0x2C7 => 0xFF,

        // Mappings from Table 115 on Page 266 of the PDF spec
        (char)0x2260 => 0xAD,
        (char)0x221E => 0xB0,
        (char)0x2264 => 0xB2,
        (char)0x2265 => 0xB3,
        (char)0x2202 => 0xB6,
        (char)0x2211 => 0xB7,
        (char)0x220F => 0xB8,
        (char)0x3A0 => 0xB9,
        (char)0x3C0 => 0xB9,
        (char)0x222B => 0xBA,
        (char)0x2216 => 0xBD,
        (char)0x3C9 => 0xBD,
        (char)0x221A => 0xC3,
        (char)0x2248 => 0xC5,
        (char)0x2206 => 0xC6,
        (char)0x25CA => 0xD7,
        (char)0x20AC => 0xDB,
        (char)0xF8FF => 0xF0,
        _ => input
    });
}